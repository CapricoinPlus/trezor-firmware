image: registry.gitlab.com/satoshilabs/trezor/trezor-firmware/environment

#style prebuild:
#  stage: prebuild
#  only:
#    changes:
#      - ci/**/*
#      - "**/*.c"
#      - "**/*.h"
#      - "**/*.py"
#  script:
#    - pipenv run make style_check
#
#common prebuild:
#  stage: prebuild
#  only:
#    changes:
#      - ci/**/*
#      - "**/*.json"
#      - "**/*.proto"
#  script:
#    - pipenv run make defs_check
#
#gen prebuild:
#  stage: prebuild
#  only:
#    changes:
#      - ci/**/*
#      - "**/*.c"
#      - "**/*.h"
#      - "**/*.json"
#      - "**/*.proto"
#      - "**/*.py"
#      - "**/*.pyi"
#  script:
#    - pipenv run make gen_check

xxx:
  stage: prebuild
  variables:
    DEPLOY_PATH: "${DEPLOY_BASE_DIR}/releases/emulators"
  before_script: []  # no pipenv
  script:
    - cp ${DEPLOY_BASE_DIR}/upgrade_tests/trezor-emu-core-v2.3.3 ${DEPLOY_BASE_DIR}/releases/emulators/
    - cp ${DEPLOY_BASE_DIR}/upgrade_tests/trezor-emu-legacy-v1.9.3 ${DEPLOY_BASE_DIR}/releases/emulators/
    - mv ${DEPLOY_BASE_DIR}/releases/emulators/trezor-emu-core-v2.3.2-63ebb8cc ${DEPLOY_BASE_DIR}/releases/emulators/trezor-emu-core-v2.3.2
    - mv ${DEPLOY_BASE_DIR}/releases/emulators/trezor-emu-legacy-v1.9.2-63ebb8cc ${DEPLOY_BASE_DIR}/releases/emulators/trezor-emu-legacy-v1.9.2
  tags:
    - deploy
